<?php


function mo_oauth_client_page_restriction()
{
    ob_start();
    global $lT;
    $zB = $lT->get_plugin_config();
    $Ic = $zB->get_config("\162\x65\163\164\x72\x69\143\x74\137\x74\157\x5f\x6c\157\x67\147\145\144\x5f\151\156\137\165\163\x65\162\x73");
    $Ic = '' !== $Ic ? $Ic : false;
    $sK = $zB->get_config("\141\x75\164\x6f\x5f\162\145\144\151\162\x65\x63\164\137\145\x78\143\x6c\165\144\x65\137\165\162\x6c\163");
    if (!(!is_user_logged_in() && boolval($Ic) && !strpos($lT->get_current_url(), "\57\x73\143\151\x6d"))) {
        goto sX3;
    }
    if (!("\x50\x4f\x53\124" === $_SERVER["\122\x45\x51\125\x45\x53\x54\137\115\105\x54\x48\117\x44"])) {
        goto Phd;
    }
    return;
    Phd:
    if (!(isset($_REQUEST["\x6f\141\x75\x74\x68\x6c\x6f\x67\151\x6e"]) && "\x66\x61\154\163\145" === $_REQUEST["\157\x61\165\x74\x68\x6c\157\x67\151\x6e"] && strpos($lT->get_current_url(), "\x2f\x77\160\55\x6c\x6f\147\151\x6e\56\x70\150\160"))) {
        goto Pcp;
    }
    return;
    Pcp:
    if (!(isset($_REQUEST[\MoOAuthConstants::OPTION]) && "\x6f\141\x75\x74\x68\162\145\x64\x69\162\x65\143\x74" === $_REQUEST[\MoOAuthConstants::OPTION])) {
        goto j0z;
    }
    return;
    j0z:
    if (!(isset($_REQUEST["\143\x6f\x64\x65"]) && '' !== $_REQUEST["\143\x6f\x64\x65"])) {
        goto cI1;
    }
    return;
    cI1:
    if (!(isset($_REQUEST["\141\x63\x63\145\163\x73\x5f\x74\x6f\x6b\x65\x6e"]) && '' !== $_REQUEST["\x61\x63\143\x65\x73\x73\x5f\x74\157\x6b\x65\156"])) {
        goto T_T;
    }
    return;
    T_T:
    if (!(isset($_REQUEST["\x6c\x6f\x67\151\x6e"]) && "\x70\167\144\147\162\156\164\x66\162\x6d" === $_REQUEST["\x6c\x6f\x67\151\x6e"])) {
        goto jku;
    }
    return;
    jku:
    if (!(isset($_REQUEST["\x65\162\x72\157\x72"]) && '' !== $_REQUEST["\145\162\x72\x6f\x72"] || isset($_REQUEST["\x65\x72\162\157\162\x5f\x64\x65\163\x63\162\x69\x70\x74\x69\x6f\156"]) && '' !== $_REQUEST["\x65\162\162\157\x72\137\144\145\x73\143\162\151\160\x74\151\x6f\x6e"])) {
        goto kKO;
    }
    return;
    kKO:
    $Da = $lT->get_all_headers();
    if (!(isset($Da["\x41\x43\x43\x45\x50\124"]) && "\x61\160\x70\x6c\x69\143\x61\x74\x69\157\x6e\57\152\163\x6f\156" === $Da["\101\103\103\x45\120\124"])) {
        goto loR;
    }
    return;
    loR:
    if (empty($sK)) {
        goto tuR;
    }
    $jK = $lT->get_current_url();
    $jK = trim($jK, "\57");
    $FI = apply_filters("\x6d\x6f\137\x6f\141\x75\x74\150\137\x63\154\x69\145\156\164\137\x66\157\162\143\145\144\x5f\x6c\157\x67\151\x6e\x5f\x65\170\x63\154\x75\x64\x65\x5f\165\162\x6c\163", $sK, $jK);
    if (!($FI === true)) {
        goto TtN;
    }
    return;
    TtN:
    $sK = explode("\xa", $sK);
    foreach ($sK as $nl) {
        if (!ctype_space(substr($nl, -1))) {
            goto ZPl;
        }
        $nl = substr_replace($nl, '', -1);
        ZPl:
        $nl = trim(trim($nl), "\x2f");
        if (!(substr($nl, -1) == "\52")) {
            goto E1j;
        }
        $nl = substr_replace($nl, '', -1);
        $nl = trim($nl, "\57");
        if (!(strpos($jK, $nl) !== false)) {
            goto Ll2;
        }
        return;
        Ll2:
        E1j:
        if (empty($nl)) {
            goto zNE;
        }
        if (!($jK === $nl)) {
            goto eBz;
        }
        return;
        eBz:
        zNE:
        MMD:
    }
    Z9M:
    tuR:
    $mo = $lT->get_app_by_name();
    if ($mo) {
        goto qmv;
    }
    return;
    qmv:
    $PR = $mo->get_app_config("\x61\x66\x74\x65\162\x5f\154\x6f\x67\151\156\137\165\162\154");
    $jK = $PR ? $PR : $lT->get_current_url();
    $PL = '';
    $PL = apply_filters("\x6d\157\x5f\157\141\x75\164\x68\137\143\x75\163\x74\x6f\155\151\x7a\145\x5f\x72\145\x64\151\x72\145\x63\x74\x69\x6f\x6e\137\155\163\x67", $PL);
    header("\x63\x61\143\x68\x65\x2d\143\157\x6e\164\x72\x6f\x6c\x3a\40\x6d\141\x78\55\141\x67\x65\x3d\60\54\40\160\162\151\x76\141\x74\145\x2c\40\x6e\157\x2d\x73\164\x6f\x72\x65\54\40\156\157\x2d\143\141\143\150\145\x2c\x20\155\x75\x73\164\55\162\x65\x76\141\154\x69\144\141\x74\x65");
    if (!empty($PL)) {
        goto l0g;
    }
    if (!empty($lT->mo_oauth_client_get_option("\155\157\x5f\x6f\141\x75\164\150\137\143\x6c\x69\x65\156\164\137\146\157\162\x63\145\x64\137\x6d\145\x73\x73\141\147\145")) && $lT->mo_oauth_client_get_option("\155\157\137\157\x61\x75\164\150\x5f\143\x6c\x69\x65\x6e\164\137\146\157\x72\x63\x65\x64\137\x6d\145\163\x73\141\147\x65") != '') {
        goto GhK;
    }
    echo "\x52\x65\144\151\x72\x65\143\164\151\156\x67\x20\x74\157\x20\144\145\146\141\165\154\x74\x20\x6c\x6f\147\151\156\x2e\56";
    goto Wzp;
    l0g:
    echo $PL;
    goto Wzp;
    GhK:
    echo $lT->mo_oauth_client_get_option("\x6d\x6f\137\x6f\x61\165\x74\x68\137\143\154\x69\145\156\164\137\x66\157\x72\143\x65\x64\x5f\155\145\163\x73\x61\x67\x65");
    Wzp:
    echo "\11\x9\x3c\163\143\162\151\160\x74\x3e\12\x9\11\11\x69\x66\x28\40\167\x69\x6e\144\157\x77\56\154\x6f\x63\x61\164\151\x6f\x6e\56\x68\162\x65\x66\x2e\x69\x6e\x64\145\170\x4f\146\50\x22\x23\x61\x63\143\145\x73\x73\x5f\164\x6f\153\x65\x6e\x22\x29\76\x2d\x31\40\174\x7c\40\167\x69\156\x64\x6f\x77\56\154\x6f\143\x61\x74\x69\x6f\156\56\150\x72\x65\x66\x2e\x69\x6e\x64\145\x78\x4f\x66\x28\42\x23\x63\157\x64\x65\x22\x29\76\55\x31\40\x7c\174\40\167\151\156\x64\157\x77\56\x6c\157\143\141\x74\x69\157\156\56\150\x72\x65\146\56\x69\156\x64\145\170\117\146\x28\42\43\151\x64\137\164\x6f\153\x65\x6e\x22\x29\76\x2d\x31\x20\x29\x20\x7b\xa\11\11\11\11\x76\141\162\40\x75\x72\x6c\40\75\x20\167\151\156\x64\x6f\167\56\154\157\x63\x61\x74\x69\x6f\x6e\x2e\164\157\x53\x74\162\x69\x6e\147\x28\x29\x3b\12\11\11\x9\11\x77\151\156\144\157\x77\56\x6c\x6f\143\141\x74\151\x6f\x6e\x20\x3d\40\x75\x72\x6c\x2e\x72\x65\160\154\x61\x63\145\x28\x22\43\x22\x2c\x20\x27\x3f\47\x29\x3b\12\11\x9\11\175\40\12\11\x9\x9\145\x6c\x73\145\40\151\146\x28\50\x77\151\156\144\x6f\167\56\154\x6f\x63\141\x74\x69\157\x6e\x2e\x68\162\145\x66\56\x69\156\144\x65\170\x4f\146\50\x22\43\163\x74\x61\164\x65\x22\51\x3e\x2d\x31\40\x26\46\x20\50\167\151\156\x64\157\167\56\154\x6f\x63\x61\x74\x69\x6f\156\56\x68\162\x65\146\x2e\151\x6e\144\x65\170\117\x66\x28\42\x65\x72\162\x6f\162\42\x29\76\55\x31\40\174\174\x20\167\151\156\x64\157\x77\x2e\154\x6f\143\141\164\151\x6f\x6e\56\150\x72\145\146\x2e\151\x6e\x64\145\x78\117\146\x28\42\x65\x72\x72\157\x72\x5f\x64\x65\x73\x63\162\x69\160\164\x69\x6f\156\x22\51\76\x2d\x31\x29\x29\x20\174\174\40\x77\151\156\144\157\167\56\154\157\143\x61\164\151\x6f\156\x2e\150\162\145\x66\x2e\x69\x6e\x64\x65\170\117\146\50\x22\x23\145\x72\162\157\162\42\x29\x3e\55\61\x20\174\x7c\40\x77\x69\156\144\x6f\167\56\x6c\157\143\x61\x74\x69\x6f\x6e\x2e\150\x72\145\x66\56\x69\156\x64\145\x78\117\x66\50\x22\x23\145\162\162\x6f\162\137\x64\x65\163\143\162\151\160\x74\x69\157\x6e\x22\x29\x3e\x2d\x31\x20\51\x20\x7b\x9\xa\x9\11\x9\x9\166\x61\x72\x20\x75\x72\154\x20\x3d\x20\167\151\156\x64\157\x77\56\x6c\x6f\143\x61\164\x69\157\x6e\x2e\x74\157\123\164\x72\151\156\147\50\51\x3b\12\11\x9\11\11\167\x69\156\144\x6f\167\56\x6c\x6f\143\141\164\151\157\x6e\40\75\x20\x75\x72\x6c\x2e\x72\x65\160\x6c\141\143\x65\50\42\43\x22\54\x20\47\77\47\51\73\12\11\x9\11\175\40\xa\11\x9\x9\145\x6c\x73\x65\40\151\x66\50\x20\x28\40\x77\x69\x6e\144\x6f\167\x2e\x6c\157\143\x61\x74\151\157\156\56\150\162\x65\146\x2e\x69\x6e\144\145\170\117\x66\50\42\43\42\x29\40\x3e\x20\55\61\40\51\x20\x29\40\x7b\11\xa\x9\x9\x9\x9\166\x61\162\x20\165\x72\154\x20\x3d\40\167\151\156\144\x6f\x77\x2e\x6c\157\143\141\164\x69\x6f\x6e\56\x74\x6f\123\164\162\151\156\x67\x28\x29\x3b\12\11\x9\x9\x9\x77\151\156\144\157\167\x2e\x6c\157\143\141\x74\x69\x6f\x6e\x20\x3d\40\165\162\x6c\x2e\162\x65\x70\154\x61\x63\x65\x28\x22\43\x22\54\x20\x27\x6d\x6f\x5f\x63\x68\141\156\x67\x65\137\164\x6f\x5f\x68\141\163\150\x27\51\x3b\12\x9\x9\11\175\40\145\x6c\x73\145\x20\x7b\xa\11\x9\11\x9\166\141\162\x20\165\x72\154\40\75\40\42";
    echo site_url();
    echo "\42\73\12\x9\x9\x9\11\165\x72\x6c\x20\x3d\x20\x75\162\154\40\x2b\x20\x27\57\77\x6f\160\164\151\x6f\156\75\157\x61\x75\x74\150\162\145\144\x69\162\x65\x63\x74\x26\x61\160\160\137\156\141\155\145\75\x27\40\x2b\40\42";
    echo wp_kses($mo->get_app_name(), \mo_oauth_get_valid_html());
    echo "\42\x20\x2b\40\47\x26\162\x65\x64\151\x72\x65\143\x74\137\x75\x72\154\x3d\x27\x20\x2b\40\42";
    echo rawurlencode($jK);
    echo "\x22\x20\x2b\40\x27\x26\162\x65\x73\x74\x72\x69\x63\x74\x72\145\x64\x69\x72\x65\x63\164\x3d\164\162\x75\x65\x27\73\xa\11\11\11\x9\x77\151\x6e\144\157\x77\56\154\157\143\x61\x74\x69\x6f\x6e\56\x72\x65\x70\154\141\143\145\50\40\165\x72\x6c\x20\51\x3b\12\11\x9\x9\175\12\11\x9\x3c\x2f\x73\143\x72\151\x70\x74\x3e\12\11\11";
    exit;
    sX3:
}
add_action("\x69\156\151\x74", "\155\x6f\x5f\x6f\x61\x75\x74\x68\137\x63\154\151\145\156\164\x5f\x70\x61\147\x65\137\162\x65\163\x74\x72\151\x63\164\x69\157\156");
